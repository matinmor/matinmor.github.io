<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Annotation Tool</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        img {
            width: 200px;
            height: auto;
            margin: 10px;
        }
        .statement {
            margin: 20px 0;
        }
        .statement label {
            margin-right: 10px;
        }
        .buttons {
            margin-top: 20px;
        }
    </style>
    <script>
        let currentQuestionIndex = 0;
        let responses = [];

        const data = CS_RAG_LLaVALLAMA.json;

        function loadQuestion(index) {
            const questionData = data[index];
            document.getElementById('question').innerText = questionData['Question'];

            const imagesContainer = document.getElementById('images');
            imagesContainer.innerHTML = '';
            questionData['img_dir'].forEach(image => {
                const imgElement = document.createElement('img');
                imgElement.src = image;
                imagesContainer.appendChild(imgElement);
            });

            const statementsContainer = document.getElementById('statements');
            statementsContainer.innerHTML = '';
            questionData['out'].forEach((statement, idx) => {
                const statementDiv = document.createElement('div');
                statementDiv.classList.add('statement');
                statementDiv.innerHTML = `
                    <p>${statement}</p>
                    <label>
                        <input type="radio" name="response_${idx}" value="correct"> Correct
                    </label>
                    <label>
                        <input type="radio" name="response_${idx}" value="incorrect"> Incorrect
                    </label>
                    <label>
                        <input type="radio" name="response_${idx}" value="subjective"> Subjective
                    </label>
                `;
                statementsContainer.appendChild(statementDiv);
            });
        }

        function nextQuestion() {
            const response = {};
            const statementsContainer = document.getElementById('statements');
            const inputs = statementsContainer.querySelectorAll('input[type="radio"]:checked');
            inputs.forEach(input => {
                response[input.name] = input.value;
            });

            if (inputs.length === document.querySelectorAll('.statement').length) {
                responses.push(response);
                currentQuestionIndex++;

                if (currentQuestionIndex < data.length) {
                    loadQuestion(currentQuestionIndex);
                } else {
                    saveResponses();
                }
            } else {
                alert('Please answer all statements before proceeding.');
            }
        }

        function saveResponses() {
            const a = document.createElement('a');
            const file = new Blob([JSON.stringify(responses, null, 2)], { type: 'application/json' });
            a.href = URL.createObjectURL(file);
            a.download = 'responses.json';
            a.click();
        }

        window.onload = () => {
            loadQuestion(currentQuestionIndex);
        };
    </script>
</head>
<body>
    <h1 id="question">Question will appear here</h1>
    <div id="images"></div>
    <form id="statements"></form>
    <div class="buttons">
        <button type="button" onclick="nextQuestion()">Next</button>
        <button type="button" onclick="saveResponses()">Save</button>
    </div>
</body>
</html>
